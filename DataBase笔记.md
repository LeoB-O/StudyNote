# 数据库系统概论

## 第一章 绪论

### 1.1数据库系统概述

#### 1. 数据(Data)
描述事物的符号记录称为数据。    
数据的含义称为**数据的语义**，数据与其语义是不可分的。    
把不同数据组织在一起，形成一种新的数据，成为**记录**。记录是计算机中表示和存储数据的一种格式或一种方法。

#### 2. 数据库(DataBase, DB)
数据库是长期存储在计算机内，有组织的、可共享的大量数据的集合。    
数据库中的数据按照一定的数据模型组织、描述和存储。具有**较小的冗余度**、**较高的数据独立性**和**易扩展性**，并可为各种用户**共享**。

概括地讲，数据库数据具有 ==**永久存储**==、 ==**有组织**== 和 ==**可共享**== 三个基本特点。

#### 3. 数据库管理系统(DataBase Management System, DBMS)
数据库管理系统是位于用户与操作系统之间的一层数据管理软件。它的主要功能包括：
1. 数据定义功能
2. 数据组织、存储和管理 **(P5)**
3. 数据操纵功能    
查询、插入、修改、删除(CRUD)
4. 数据库的事务管理和运行管理
5. 数据库的建立和维护功能
6. 其他功能

#### 4.数据库系统(DataBase System, DBS)
数据库系统是由数据库、数据库管理系统（及其应用开发工具）、应用程序和数据库管理员(DataBase Administrator, DBA)组成的存储、管理、处理和维护数据的系统。

#### 1.1.3数据库系统的特点
1. 数据结构化    
数据库系统实现整体数据的结构化，这是数据库的主要特征之一，也是数据库与文件系统的本质区别。
2. 数据共享性高，冗余度低且易扩充。
3. 数据独立性高    
数据独立性是指：物理独立性和逻辑独立性。    
物理独立性是指：用户的应用程序与数据库中的数据的物理存储是相互独立的。    
逻辑独立性是指：应用程序与数据库的逻辑结构是相互独立的。
4. 数据由数据库管理系统统一管理和控制 **（P13）**

### 1.2 数据模型
数据模型是一种模型，它是**对现实世界数据特征的抽象**。也就是说，数据模型是用来描述数据、组织数据和对数据进行操作的。

通俗的讲，数据模型就是现实世界的模拟。

数据模型是数据库系统的核心和基础。现有的数据库都是基于某种数据模型的。

#### 1.2.1 两类数据模型
数据模型划分为两大类：第一类是**概念模型**，第二类是**逻辑模型和物理模型**。

概念模型也称信息模型，它是按照用户的观点来对数据和信息建模，主要用于数据库设计。

第二类中的逻辑模型是按计算机系统的观点对数据建模，主要用于数据库管理系统的实现。    
第二类中的物理模型是对数据最底层的抽象，它描述数据在系统内部的表示方式和存取方法，是面向计算机系统的。它是数据库管理系统的任务，最终用户不必考虑。

#### 1.2.2 概念模型
信息世界中的一些基本概念：

（1）实体（entity）：    
> 客观存在并可相互区别的事物

（2）属性（attribute）：
> 实体所具有的某一特性

（3）码（key）：
> 唯一标识实体的属性集

（4）实体型（entity type）：
> 用实体名及其属性名集合来抽象和刻画同类实体，成为实体型。    
例如：学生（姓名，性别，出生年月，所在院系，入学时间）就是一个实体型。

（5）实体集（entity set）：
> 同一类型的实体的集合。如：全体学生就是一个实体集。

（6）联系（relationship）：
> 包括实体（型）内部的联系和实体（型）之间的联系。

#### 1.2.3 数据模型的组成要素
数据模型通常由**数据结构**、**数据操作**和**数据的完整性约束条件**三部分组成。
##### 1. 数据结构
数据结构描述数据库的组成对象以及对象之间的联系。
##### 2. 数据操作
数据操作是指对数据库中各种对象（型）的实例（值）允许执行的操作的集合，包括操作以及有关的操作规则。
##### 3. 数据的完整性约束条件
数据的完整性约束条件是一组完整性规则。用以限定符合数据模型的数据库状态以及状态的变化，以保证数据的正确、有效和相容。

#### 1.2.4 常用的数据模型
- 层次模型
- 网状模型
- 关系模型
- 面向对象数据模型
- 对象关系数据模型
- 半结构化数据模型

其中，层次模型和网状模型统称为格式化模型。在格式化模型中，数据结构的单位是**基本层次联系**。

所谓**基本层次联系**是指两个记录，以及它们之间的一对多（包括一对一）的联系。**（P19）**

#### 1.2.5 层次模型
层次模型使用树形结构来表示各类实体以及实体间的联系。
##### 1. 层次模型的数据结构
在数据库中，满足以下两个条件的基本层次联系的集合成为层次模型:

> (1) 有且只有一个结点没有双亲结点，这个结点称为根节点    
(2) 根以外的其他结点有且只有一个双亲结点。

在层次模型中，每个结点表示一个记录类型，记录类型之间的联系用结点之间的连线（有向边）表示。这种联系是一对多的，因此层次数据库系统只能处理一对多的实体联系。**（树形结构）**

每个记录类型包含若干个字段。记录类型描述实体，字段描述实体的属性。

层次模型的一个基本特点是，任何一个给定的记录值只能按照其层次路径查看，没有一个子女记录能够脱离双亲记录而独立存在。**（图例见P21）**

##### 2. 层次模型的数据操作与完整性约束
操作主要包括：查询、插入、删除和更新。这些操作应该满足层次模型的完整性约束条件：**插入结点必须指定对应父节点，删除父节点应同时删除子节点。**

#### 1.2.6 网状模型
##### 1. 网状模型的数据结构
在数据库中，满足以下两个条件的基本层次联系集合成为网状模型：

> (1) 允许一个以上结点无双亲。    
(2) 一个结点可以有多于一个的双亲。

层次模型实际上是网状模型的一个特例。与层次模型一样，每个节点表示一个记录类型（实体），每个记录类型可包含若干个字段（实体的属性），结点间的连线表示记录类型（实体）之间一对多的父子联系。**（实际上应该可以说是图）**

##### 2. 网状模型的数据操纵与完整性约束
支持记录码，保证一个联系中双亲记录和子女记录是一对多的关系。支持双亲记录和子女记录之间的某些约束条件，如某些子女记录要求双亲记录存在时才能插入，双亲记录删除时子女记录也连同删除。

缺点：DDL（Data Definition Language）和DML（Data ManipulationLanguage）复杂。

#### 1.2.7 ==关系模型==
==**这个模型是本书的重点模型**==
##### 1. 关系模型的数据结构
关系模型与其他模型不同，是建立在严格的数学概念上的。这里简单勾划一下关系模型。

从用户的观点看，关系模型由一组关系组成，每个关系的数据结构是一张规范化的二维表。

==**相关术语：**==
- 关系（relation）：一个关系对应通常说的一张表。
- 元组（tuple）：表中的一行即为一个元组
- 码（key）：也称键。它是表中的某个属性组，可以唯一确定一个元组。（个人理解：主键）
- 域（domain）：域是一组具有相同数据类型的值的集合。属性的取值范围来自于某个域。
- 分量：元组中的一个属性值
- 关系模式：对关系的描述，一般表述为```关系名 (属性1，属性2，···，属性n）```
关系模型要求关系必须是规范化的，其中最基本的一条是，关系中的每一个分量必须是一个不可分的数据项。

**关系模型和现实生活中的表格术语对比：**

|关系术语 |一般表格的术语 |
|-|-|
|关系名|表名|
|关系模式|表头|
|关系|（一张）二维表|
|元祖|记录或行|
|属性|列|
|属性名|列名|
|属性值|列值|
|分量|一条记录中的一个列值|
|非规范关系|表中有表|

##### 2. 关系模型的数据操作与完整性约束
操作包括：查询、插入、删除和更新

完整性约束条件包括三大类：**实体完整性**、**参照完整性**和**用户定义的完整性**。（具体见后续章节）

关系模型中的数据操作都是集合操作，即对若干元组的集合的操作。

### 1.3 数据库系统的结构
通常采用三级模式结构。
#### 1.3.1 数据库系统模式的概念
模型有```型（type）```和```值（value）```的概念。

模式是数据库中全体数据的逻辑结构和特征的描述。它仅仅涉及型的描述，不涉及具体的值。模式的一个具体值成为模式的一个实例。
#### 1.3.2 数据库系统的三级模式结构
包括**外模式**、**模式**以及**内模式**三级构成。
##### 1.模式
模式也称逻辑模式，是数据库中全体数据的逻辑结构和特征的描述。一个数据库**只有一个模式**。是所有用户的公共数据试图。（个人理解：中间层，主要是数据库设计以及直接操作数据库的时候的视图）

##### 2. 外模式
外模式是数据库用户能看见的和使用的局部数据的逻辑结构和特征的描述，是数据库用户的数据视图，是与某一应用有关的数据的逻辑表示。（个人理解：应用开发时和用户使用时的视图）

##### 3. 内模式
也称存储模式，一个数据库**只有一个内模式**。他是数据物理结构和存储方式的描述。(个人理解：数据库管理设计，底层模式)

#### 1.3.3 数据库的二级映像功能与数据独立性
三级模式之间有两层映像：```外模式/模式映像```和```模式/内模式映像```。
##### 1.外模式/模式映像
个人理解：模式和外模式之间的一种映射关系。模式改变时可以不改变外模式，只改变映像，或者说映射？

##### 2. 模式/内模式映像
个人理解：内模式和模式之间的一种映射关系。存储结构改变时，即内模式改变，模式也可以保持不变，外模式也可以不变。即数据与应用程序之间具有独立性。

### 1.4 数据库系统的组成
#### 1. 硬件平台及数据库
数据库系统对计算机硬件有较高要求。
#### 2. 软件

#### 3.人员
1. 数据库管理员
2. 系统分析员和数据库设计人员
3. 应用程序员
4. 用户

## 第二章 关系数据库
### 2.1 关系数据结构及形式化定义
==关系模型由关系数据结构，关系操作集合和关系完整性约束三部分组成。==
#### 2.1.1 关系
关系数据结构的形式化定义：
##### 1. 域（domain）    
域是一组具有相同数据类型的值的集合
##### 2. 笛卡儿积    
域上的一种集合运算 **（P38）**
##### 3. 关系（relation）    
域的笛卡儿积的子集，几个域表示关系的```目```或者说```度```的数目。    
度为1则称该关系为单元关系，度为2则称为二元关系。   

若关系中的某一**属性组**能唯一的标识一个元组，**而其子集不能**，则称该属性组为**候选码（candidate key）**。   

若一个关系有多个候选码，则选定其中一个为**主码（primary key）**。

候选码的各种属性称为**主属性（prime attribute）**。不包含在任何候选码中的属性称为**非主属性（non-prime attribute）**或**非码属性（non-key attribute）**。  

在最简单的情况下，候选码只包含一个属性。在最极端的情况下，关系模式的所有属性都是这个关系模式的候选码，则称为 **全码（all-key）**。

关系可以有三种基本类型：```基本类型（通常又称为基本表或基表）```、```查询表```、```视图表```。其中，基本表是实际存在的表，查询表是查询结果对应的表，视图表是由基本表或者其他视图表导出的表，是虚表。

在关系数据结构的规范条件中，最基本的一条就是：==**关系的每一个分量必须是一个不可再分的数据项**==

#### 2.1.2 关系模式（relation schema）
关系的描述称为**关系模式**，它可以形式化的表示为```R(U,D,DOM,F)```。其中R为关系名，U为组成该关系的属性名集合，D为U中属性所来自的域，DOM为属性向域的映像的集合，F为属性间数据的依赖关系集合。

#### 2.1.3 关系数据库
关系数据库有**型**和**值**。    
关系数据库的型也称为关系数据库模式，是对关系数据库的描述。    
关系数据库的值是这些关系模式在某一时刻对应的关系的集合，通常就称为关系数据库。

#### 2.1.4 关系模型的存储结构
**P（43）**

### 2.2 关系操作
#### 2.2.1 基本的关系操作
关系模型中常用的操作包括：**查询**、**插入**、**删除**、**修改**。    
其中，查询操作又可以分为：**选择、投影、链接、除、并、差、交、笛卡儿积**等。 其中==选择、投影、并、差、笛卡儿积==是5种基本操作。

关系操作的特点是集合操作。即操作的对象和结果都是集合。
#### 2.2.2 关系数据语言的分类
早期的关系操作通常使用**关系代数**和**关系演算**来表示。关系演算又可以分为**元组关系演算*和**域关系演算**。还有一种介于关系代数和关系演算之间的**结构化查询语言**。

### 2.3 关系的完整性
关系模型中有三种完整性约束：**实体完整性、参照完整性、用户定义的完整性**。其中，实体完整性和参照完整性是关系模型所必须满足的完整性约束条件，被称为是关系的两个不变性。
#### 2.3.1 实体完整性
个人理解：属性如果是主属性则不可取空值 **（P45）**
#### 2.3.2 参照完整性
个人理解：引用其他关系的属性的时候必须满足一定的条件，比如说该属性的取值必须存在。 **（P46）**

> 设F是基本关系R的一个或一组属性，但不是关系R的码，Ks是关系的主码。如果F与Ks相对应，则称F是R的外码，并称基本关系R为参照关系，基本关系S为被参照关系或目标关系。其中R和S可以是同一个关系。

个人理解: 关系A中的某些非主码的属性应用了关系B的主码，则称A中的那些非主码为```外码```，关系A是参照关系，关系B是被参照关系。关系可以参照自己。

#### 2.3.3 用户定义的完整性
**（P48）**

### 2.4 关系代数
关系代数是一种**查询语言**，它用对关系的运算来表达查询。

关系代数的运算可以分为两种：
1. 传统的集合运算
2. 专门的关系运算
#### 2.4.1 传统的集合运算
包括**并、差、交、笛卡儿积**。

==**（P49）**==

#### 2.4.2 专门的关系运算
##### 1. 选择（P51）
``` σF(R) ```表示在R中选择满足F条件的元组。    
F的基本形式为```X1 θ Y1```，其中θ表示比较运算符，可以是```＞，＜，≥，≤，＝或≠```。
##### 2. 投影（P53）
```ΠA(R)``` 表示在 **关系R** 中选中 **A属性组**。
##### 3.连接（P53）
``` R⋈S ```  
个人理解：把具有相同属性列的两个关系连接起来。如何连接主要依据相同的属性列之间的逻辑关系。

连接包括```θ连接```，```等值连接```，```自然连接```。θ为=时称为等值连接，在结果中去掉重复的属性列称为自然连接。

进行自然连接时，R和S中的某些元组可能不具有相等的属性值，因而这些元组被舍弃掉了。这些被舍弃的元组称为**悬浮元组**。如果把悬浮元组也保留在结果中，在其他属性上填上**空值（NULL）**，那么这种连接就叫做**外连接**，记作```⟗```。如果只保留左边关系R中的悬浮元组，则称为**左外连接**，记作```⟕```，如果只保留右边的，则成为**右外连接**，记作```⟖```。

##### 4. 除运算（P56）
``` R÷S=T ```

个人理解：求一关系T，使得T与S的所有组合都在R中。且R中不含任何S中的属性。

## 第三章 关系数据库标准语言SQL
### 3.1 SQL概述
#### 3.1.1 SQL的产生与发展（P75）
#### 3.1.2 SQL的特点（P76）



# 习题
## 第1章
### 1. 试述数据、数据库、数据库管理系统、数据库系统的概念。
### 2. 文件系统与数据库系统的区别和联系
### 3. 数据库系统的特点
### 4. 数据库管理系统的主要功能
### 5. 什么事概念模型？概念模型的作用？
### 6. 数据模型的概念，数据模型的作用和数据模型的三要素？
### 7. 网状模型的概念，举出三个网状模型的实例？
### 8. 什么叫数据与程序的物理独立性？什么叫数据与程序的逻辑独立性？什么叫数据库系统具有数据与程序的独立性？
### 9. 数据库系统的组成？
### 10. 数据库管理员、系统分析员、数据库设计人员、应用程序员的职责？

## 第2章
### P70